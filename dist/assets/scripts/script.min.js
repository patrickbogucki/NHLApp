var app=angular.module("NHLApp",["ngRoute","ngResource"]);app.config(["$routeProvider",function(e){e.when("/",{controller:"MainController",templateUrl:"assets/scripts/views/main.html"}).when("/:teamID",{controller:"TeamController",templateUrl:"assets/scripts/views/team.html"}).otherwise({redirectTo:"/"})}]),app.controller("MainController",["$scope","teams","teamsDetailed","teamLogos",function(e,a,t,i){function n(){a.then(function(a){e.teams=a.data,t.then(function(t){var i=t.data.standings["info-teams"][0]["team-standing"];o(i,a.data),e.teamsWithStats=i})})["catch"](function(e){console.log("error")})}function o(e,a){for(var t=0;t<e.length;t++){void 0!==e[t].$&&(e[t]=e[t].$),e[t].fullName="FAIL";for(var i=0;i<a.length;i++){if(r(e[t],a[i])){u(e[t],a[i]);break}if(s(e[t])){l(e[t],c);break}if(d(e[t])){l(e[t],p);break}}}}function r(e,a){return e.name===a.name.substr(0,e.name.length)}function s(e){return e.name===c.name}function d(e){return e.name===p.name}function l(e,a){e.fullName=a.fullName,e.teamID=a.teamID}function u(e,a){e.fullName=a.name,e.teamID=a.teamID}e.title="Teams",e.predicate="fullName",e.conferences={Western:!0,Eastern:!0},e.divisions={Atlantic:!0,Central:!0,Metropolitan:!0,Pacific:!0},e.reverse=!1,e.order=function(a){e.reverse=e.predicate===a?!e.reverse:!1,e.predicate=a},e.getTeamLogoImgSrc=function(e){return i.getTeamLogoImgSrc(e)};var c={name:"NY Islanders",fullName:"New York Islanders",teamID:"NYI"},p={name:"NY Rangers",fullName:"New York Rangers",teamID:"NYR"};n()}]),app.controller("TeamController",["$scope","$location","teams","teamRoster",function(e,a,t,i){function n(){t.then(function(a){for(var t=0;t<a.data.length;t++)if(i.teamID()===a.data[t].teamID){e.teamName=a.data[t].name;break}})}function o(e){e.forEach(function(e,a){r(e),s(e),d(e)})}function r(e){var a="http://cdn.nhle.com/photos/mugs-silo-stats/"+e.id+".png";e.imageUrl=a}function s(e){void 0!==e.twitterHandle&&"@"!==e.twitterHandle.substr(0,1)&&(e.twitterHandle="@"+e.twitterHandle)}function d(e){i.loadTeamStats().then(function(){var a=i.getPlayerStats(e.id);e.stats=a})["catch"](function(){console.log("TeamController - addStatsToPlayer FAILED")})}e.teamName="",e.selectedGoalieIndex=void 0,e.selectedForwardIndex=void 0,e.selectedDefensemanIndex=void 0,e.goalieCardClicked=function(a){e.selectedForwardIndex=void 0,e.selectedDefensemanIndex=void 0,e.selectedGoalieIndex===a?e.selectedGoalieIndex=void 0:e.selectedGoalieIndex=a},e.forwardCardClicked=function(a){e.selectedGoalieIndex=void 0,e.selectedDefensemanIndex=void 0,e.selectedForwardIndex===a?e.selectedForwardIndex=void 0:e.selectedForwardIndex=a},e.defensemenCardClicked=function(a){e.selectedForwardIndex=void 0,e.selectedGoalieIndex=void 0,e.selectedDefensemanIndex===a?e.selectedDefensemanIndex=void 0:e.selectedDefensemanIndex=a},n(),i.fetchTeamRoster().then(function(a){e.teamRoster=a.data,o(e.teamRoster.goalie),o(e.teamRoster.forwards),o(e.teamRoster.defensemen)})["catch"](function(e){a.path("/")})}]),app.filter("byConference",function(){return function(e,a){var t={conferences:a,out:[]};return angular.forEach(e,function(e,a){this.conferences[e["conference-name"]]===!0&&this.out.push(e)},t),t.out}}),app.filter("byDivision",function(){return function(e,a){var t={divisions:a,out:[]};return angular.forEach(e,function(e,a){this.divisions[e["division-name"]]===!0&&this.out.push(e)},t),t.out}}),app.directive("myPlayerInfo",[function(){return{restrict:"E",scope:{player:"=",getPlayerStats:"&"},templateUrl:"/dev/assets/scripts/templates/my-player-info.html"}}]),app.directive("myPlayerInfoGoalie",[function(){return{restrict:"E",scope:{player:"=",getPlayerStats:"&"},templateUrl:"/dev/assets/scripts/templates/my-player-info-goalie.html"}}]),app.factory("teamLogos",[function(){return this.getTeamLogoImgSrc=function(e){switch(e){case"Anaheim Ducks":return"https://upload.wikimedia.org/wikipedia/en/7/72/Anaheim_Ducks.svg";case"Arizona Coyotes":return"https://upload.wikimedia.org/wikipedia/en/2/27/Arizona_Coyotes.svg";case"Boston Bruins":return"https://upload.wikimedia.org/wikipedia/en/1/12/Boston_Bruins.svg";case"Buffalo Sabres":return"https://upload.wikimedia.org/wikipedia/en/9/9e/Buffalo_Sabres_Logo.svg";case"Calgary Flames":return"https://upload.wikimedia.org/wikipedia/en/6/60/Calgary_Flames_Logo.svg";case"Carolina Hurricanes":return"https://upload.wikimedia.org/wikipedia/en/3/32/Carolina_Hurricanes.svg";case"Chicago Blackhawks":return"https://upload.wikimedia.org/wikipedia/en/d/d3/ChicagoBlackhawksLogo.svg";case"Colorado Avalanche":return"https://upload.wikimedia.org/wikipedia/en/4/45/Colorado_Avalanche_logo.svg";case"Columbus Blue Jackets":return"https://upload.wikimedia.org/wikipedia/en/0/04/Columbus_BlueJackets.svg";case"Dallas Stars":return"https://upload.wikimedia.org/wikipedia/en/2/2a/Dallas_Stars_logo.svg";case"Detroit Red Wings":return"https://upload.wikimedia.org/wikipedia/en/e/e0/Detroit_Red_Wings_logo.svg";case"Edmonton Oilers":return"https://upload.wikimedia.org/wikipedia/en/4/4d/Logo_Edmonton_Oilers.svg";case"Florida Panthers":return"https://upload.wikimedia.org/wikipedia/en/8/8f/Florida_Panthers.svg";case"Los Angeles Kings":return"https://upload.wikimedia.org/wikipedia/en/c/cb/Los_Angeles_Kings_Logo_%282011%29.svg";case"Minnesota Wild":return"https://upload.wikimedia.org/wikipedia/en/1/1b/Minnesota_Wild.svg";case"Montreal Canadiens":return"https://upload.wikimedia.org/wikipedia/commons/6/69/Montreal_Canadiens.svg";case"Nashville Predators":return"https://upload.wikimedia.org/wikipedia/en/9/9c/Nashville_Predators_Logo_%282011%29.svg";case"New Jersey Devils":return"https://upload.wikimedia.org/wikipedia/en/9/9f/New_Jersey_Devils_logo.svg";case"New York Islanders":return"https://upload.wikimedia.org/wikipedia/en/4/42/Logo_New_York_Islanders.svg";case"New York Rangers":return"https://upload.wikimedia.org/wikipedia/commons/a/ae/New_York_Rangers.svg";case"Philadelphia Flyers":return"https://upload.wikimedia.org/wikipedia/en/d/dc/Philadelphia_Flyers.svg";case"Pittsburgh Penguins":return"https://upload.wikimedia.org/wikipedia/en/3/3a/Pittsburgh_Penguins_logo.svg";case"Ottawa Senators":return"https://upload.wikimedia.org/wikipedia/en/d/db/Ottawa_Senators.svg";case"San Jose Sharks":return"https://upload.wikimedia.org/wikipedia/en/3/37/SanJoseSharksLogo.svg";case"St. Louis Blues":return"https://upload.wikimedia.org/wikipedia/en/e/e8/StLouis_Blues.svg";case"Tampa Bay Lightning":return"https://upload.wikimedia.org/wikipedia/en/2/2f/Tampa_Bay_Lightning_Logo_2011.svg";case"Toronto Maple Leafs":return"https://upload.wikimedia.org/wikipedia/en/f/fc/Toronto_Maple_Leafs_logo.svg";case"Vancouver Canucks":return"https://upload.wikimedia.org/wikipedia/en/3/3a/Vancouver_Canucks_logo.svg";case"Washington Capitals":return"https://upload.wikimedia.org/wikipedia/en/2/2d/Washington_Capitals.svg";case"Winnipeg Jets":return"https://upload.wikimedia.org/wikipedia/en/9/93/Winnipeg_Jets_Logo_2011.svg";default:return"https://upload.wikimedia.org/wikipedia/en/3/3a/05_NHL_Shield.svg"}},this}]),app.factory("teamRoster",["$http","$routeParams",function(e,a){this.fetchTeamRoster=function(){return e.get("/api/teamRoster/"+a.teamID)},this.teamID=function(){return console.log(a.teamID),a.teamID};var t=[],i={};return this.loadTeamStats=function(){return e.get("/api/teamRosterStats/"+a.teamID).then(function(e){t=[];for(var a,i=e.data.goalieCategories.split(", "),n=e.data.goalieData,o=0;o<n.length;o++){goalieData=n[o].data.split(", "),a={};for(var r=0;r<i.length;r++)a[i[r]]=goalieData[r];a.id=n[o].id,t.push(a)}for(var s=e.data.skaterCategories.split(", "),d=e.data.skaterData,l=0;l<d.length;l++){skaterData=d[l].data.split(", "),a={};for(var u=0;u<s.length;u++)a[s[u]]=skaterData[u];a.id=d[l].id,t.push(a)}})["catch"](function(e){})},this.getPlayerStats=function(e){for(var a=0;a<t.length;a++)if(t[a].id===e)return t[a];return i},this.getTeamStats=function(){return t},this}]),app.factory("teams",["$http",function(e){return e.get("/api/teams")}]),app.factory("teamsDetailed",["$http",function(e){return e.get("/api/teamsDetailed")}]);